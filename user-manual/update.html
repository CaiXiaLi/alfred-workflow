


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Self-Updating &mdash; Alfred-Workflow 1.9.6 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="top" title="Alfred-Workflow 1.9.6 documentation" href="../index.html"/>
        <link rel="up" title="User Manual" href="index.html"/>
        <link rel="next" title="System icons" href="icons.html"/>
        <link rel="prev" title="Background processes" href="background.html"/>
 
<!-- Only one of these will work. Seems a better solution than symlinking
the _static path in each subdirectory -->
<link rel="stylesheet" href="_static/gh-fork-ribbon.css">
<link rel="stylesheet" href="../_static/gh-fork-ribbon.css">
<link rel="stylesheet" href="_static/custom.css">
<link rel="stylesheet" href="../_static/custom.css">
<!--[if lt IE 9]>
	<link rel="stylesheet" href="_static/gh-fork-ribbon.ie.css">
<![endif]-->
<!-- <link rel="stylesheet" href="_static/custom.css"> -->
<!-- <link rel="shortcut icon" href="_static/favicon.ico"> -->


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="../index.html" class="fa fa-home"> Alfred-Workflow</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
        
            <ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#pip-pypi">pip / PyPi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#github">GitHub</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorial.html">Tutorial</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorial.html#part-1-a-basic-pinboard-workflow">Part 1: A Basic Pinboard Workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial.html#part-2-a-distribution-ready-pinboard-workflow">Part 2: A Distribution-Ready Pinboard Workflow</a></li>
</ul>
</li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">User Manual</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="setup.html">Workflow setup and skeleton</a></li>
<li class="toctree-l2"><a class="reference internal" href="third-party.html">Including 3rd party libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="persistent-data.html">Persistent data</a></li>
<li class="toctree-l2"><a class="reference internal" href="filtering.html">Searching/filtering data</a></li>
<li class="toctree-l2"><a class="reference internal" href="web.html">Retrieving data from the web</a></li>
<li class="toctree-l2"><a class="reference internal" href="background.html">Background processes</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">Self-Updating</a></li>
<li class="toctree-l2"><a class="reference internal" href="icons.html">System icons</a></li>
<li class="toctree-l2"><a class="reference internal" href="magic-args.html">&#8220;Magic&#8221; arguments</a></li>
<li class="toctree-l2"><a class="reference internal" href="serialization.html">Serialization of stored/cached data</a></li>
<li class="toctree-l2"><a class="reference internal" href="text-encoding.html">Encoded strings and Unicode</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">Alfred-Workflow API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/workflow.html">The Workflow Object</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/web.html">Fetching Data from the Web</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/background.html">Background Tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/update.html">Self-Updating</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/serialization.html">Serialization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/index.html#index">Index</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../xml_format.html">Script Filter Results and the XML Format</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../xml_format.html#xml-format-available-parameters">XML format / available parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../xml_format.html#basic-example">Basic example</a></li>
<li class="toctree-l2"><a class="reference internal" href="../xml_format.html#item-parameters">Item parameters</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../aw-workflows.html">Workflows using Alfred-Workflow</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../aw-workflows.html#adding-your-own-workflow-to-the-list">Adding your own workflow to the list</a></li>
</ul>
</li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">Alfred-Workflow</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="index.html">User Manual</a> &raquo;</li>
      
    <li>Self-Updating</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="../_sources/user-manual/update.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            
  <div class="section" id="self-updating">
<span id="manual-updates"></span><h1>Self-Updating<a class="headerlink" href="#self-updating" title="Permalink to this headline">Â¶</a></h1>
<div class="versionadded">
<p><span class="versionmodified">New in version 1.9.</span></p>
</div>
<p>Add self-updating capabilities to your workflow. It regularly (every day
by default) fetches the latest releases from the specified GitHub repository
and then asks the user if they want to replace the workflow if a newer version
is available.</p>
<div class="admonition danger">
<p class="first admonition-title">Danger</p>
<p>If you are not careful, you might accidentally overwrite a local version of
the worklow you&#8217;re working on and lose all your changes!</p>
<p>If you&#8217;re working on a workflow, it&#8217;s a good idea to make sure you increase
the version number <em>before</em> you start making any changes.</p>
<p class="last">See <a class="reference internal" href="#version-numbers"><em>Version numbers</em></a> for precise information on how
Alfred-Workflow determines whether a workflow has been updated.</p>
</div>
<p>Currently, only updates from <a class="reference external" href="https://help.github.com/categories/85/articles">GitHub releases</a> are supported.</p>
<p>For your workflow to be able to recognise and download newer versions, the
<tt class="docutils literal"><span class="pre">version</span></tt> value you pass to <a class="reference internal" href="../api/workflow.html#workflow.workflow.Workflow" title="workflow.workflow.Workflow"><tt class="xref py py-class docutils literal"><span class="pre">Workflow</span></tt></a> <strong>should</strong>
be one of the versions (i.e. tags) in the corresponding GitHub repo&#8217;s
releases list. See <a class="reference internal" href="#version-numbers"><em>Version numbers</em></a> for more information.</p>
<p>There must be one (and only one) <tt class="docutils literal"><span class="pre">.alfredworkflow</span></tt> binary attached to a
release otherwise it will be ignored. This is the file that will be downloaded
and installed via Alfred&#8217;s default installation mechanism.</p>
<p>Releases marked as <tt class="docutils literal"><span class="pre">pre-release</span></tt> will also be ignored.</p>
<p>To use this feature, you must pass a <a class="reference external" href="http://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><tt class="xref py py-class docutils literal"><span class="pre">dict</span></tt></a> as the <tt class="docutils literal"><span class="pre">update_settings</span></tt>
argument to <a class="reference internal" href="../api/workflow.html#workflow.workflow.Workflow" title="workflow.workflow.Workflow"><tt class="xref py py-class docutils literal"><span class="pre">Workflow</span></tt></a>. It <strong>must</strong> have the two
keys/values <tt class="docutils literal"><span class="pre">github_slug</span></tt>, which is your username and the name of the
workflow&#8217;s repo in the format <tt class="docutils literal"><span class="pre">username/reponame</span></tt>, and <tt class="docutils literal"><span class="pre">version</span></tt>, which
is the release version (release tag) of the currently installed version
of the workflow, e.g.:</p>
<div class="highlight-python" id="update-example"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">workflow</span> <span class="kn">import</span> <span class="n">Workflow</span>

<span class="n">__version__</span> <span class="o">=</span> <span class="s">&#39;1.1&#39;</span>

<span class="o">...</span>

<span class="n">wf</span> <span class="o">=</span> <span class="n">Workflow</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">update_settings</span><span class="o">=</span><span class="p">{</span>
    <span class="c"># Your username and the workflow&#39;s repo&#39;s name</span>
    <span class="s">&#39;github_slug&#39;</span><span class="p">:</span> <span class="s">&#39;username/reponame&#39;</span><span class="p">,</span>
    <span class="c"># The version (i.e. release/tag) of the installed workflow</span>
    <span class="s">&#39;version&#39;</span><span class="p">:</span> <span class="n">__version__</span><span class="p">,</span>
    <span class="c"># Optional number of days between checks for updates</span>
    <span class="s">&#39;frequency&#39;</span><span class="p">:</span> <span class="mi">7</span>
<span class="p">},</span> <span class="o">...</span><span class="p">)</span>

<span class="o">...</span>

<span class="k">if</span> <span class="n">wf</span><span class="o">.</span><span class="n">update_available</span><span class="p">:</span>
    <span class="n">wf</span><span class="o">.</span><span class="n">start_update</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Alfred-Workflow will automatically check in the background if a newer
version of your workflow is available, but will <em>not</em> automatically inform
the     user nor download and install the update.</p>
</div>
<p>To view update status/install a newer version, the user must either
call one of your workflow&#8217;s Script Filters with the <tt class="docutils literal"><span class="pre">workflow:update</span></tt>
<a class="reference internal" href="magic-args.html#magic-arguments"><em>magic argument</em></a>, in which case Alfred-Workflow
will handle the update automatically, or you must add your own update action
using <a class="reference internal" href="../api/workflow.html#workflow.workflow.Workflow.update_available" title="workflow.workflow.Workflow.update_available"><tt class="xref py py-attr docutils literal"><span class="pre">Workflow.update_available</span></tt></a>
and <a class="reference internal" href="../api/workflow.html#workflow.workflow.Workflow.start_update" title="workflow.workflow.Workflow.start_update"><tt class="xref py py-meth docutils literal"><span class="pre">Workflow.start_update()</span></tt></a>
to check for and install newer versions respectively.</p>
<p>The <a class="reference internal" href="../api/workflow.html#workflow.workflow.Workflow.check_update" title="workflow.workflow.Workflow.check_update"><tt class="xref py py-meth docutils literal"><span class="pre">check_update()</span></tt></a> method is called
automatically when you create a <a class="reference internal" href="../api/workflow.html#workflow.workflow.Workflow" title="workflow.workflow.Workflow"><tt class="xref py py-class docutils literal"><span class="pre">workflow.workflow.Workflow</span></tt></a> object. If
sufficient time has elapsed since the last check (1 day by default), it starts
a background process that checks for new releases. You can alter the update
interval with the optional <tt class="docutils literal"><span class="pre">frequency</span></tt> key in <tt class="docutils literal"><span class="pre">update_settings</span></tt>
<a class="reference external" href="http://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><tt class="xref py py-class docutils literal"><span class="pre">dict</span></tt></a> (see the <a class="reference internal" href="#update-example"><em>example above</em></a>).</p>
<p><a class="reference internal" href="../api/workflow.html#workflow.workflow.Workflow.update_available" title="workflow.workflow.Workflow.update_available"><tt class="xref py py-attr docutils literal"><span class="pre">Workflow.update_available</span></tt></a>
is <tt class="docutils literal"><span class="pre">True</span></tt> if an update is available, and <tt class="docutils literal"><span class="pre">False</span></tt> otherwise.</p>
<p><a class="reference internal" href="../api/workflow.html#workflow.workflow.Workflow.start_update" title="workflow.workflow.Workflow.start_update"><tt class="xref py py-meth docutils literal"><span class="pre">Workflow.start_update()</span></tt></a>
returns <tt class="docutils literal"><span class="pre">False</span></tt> if no update is available, or if one is, it will return
<tt class="docutils literal"><span class="pre">True</span></tt>, download the newer version and tell Alfred to install it.</p>
<p>If you want more control over the update mechanism, you can use
<a class="reference internal" href="../api/update.html#workflow.update.check_update" title="workflow.update.check_update"><tt class="xref py py-func docutils literal"><span class="pre">update.check_update()</span></tt></a> directly.
It caches information on the latest available release under the cache key
<tt class="docutils literal"><span class="pre">__workflow_update_status</span></tt>, which you can access via
<a class="reference internal" href="../api/workflow.html#workflow.workflow.Workflow.cached_data" title="workflow.workflow.Workflow.cached_data"><tt class="xref py py-meth docutils literal"><span class="pre">Workflow.cached_data()</span></tt></a>.</p>
<div class="section" id="version-numbers">
<span id="id1"></span><h2>Version numbers<a class="headerlink" href="#version-numbers" title="Permalink to this headline">Â¶</a></h2>
<p>Currently, Alfred-Workflow is not particularly smart when it comes to
version numbers. This may change in the future but will require imposing a
specific format for version numbers on workflow authors. If that does happen,
it will be <a class="reference external" href="http://semver.org/">semantic versioning</a>, which you should probably be using anyway.</p>
<p>The <em>de-facto</em> way to tag releases on GitHub is use a semantic version number
preceded by <tt class="docutils literal"><span class="pre">v</span></tt>, e.g. <tt class="docutils literal"><span class="pre">v1.0</span></tt>, <tt class="docutils literal"><span class="pre">v2.3.1</span></tt> etc., whereas the <em>de-facto</em> way
to version Python libraries is to do the same, but without the preceding <tt class="docutils literal"><span class="pre">v</span></tt>,
e.g. <tt class="docutils literal"><span class="pre">1.0</span></tt>, <tt class="docutils literal"><span class="pre">2.3.1</span></tt> etc.</p>
<p>As a result, Alfred-Workflow will strip a preceding <tt class="docutils literal"><span class="pre">v</span></tt> from both local
and remote versions (i.e. you can specify <tt class="docutils literal"><span class="pre">1.0</span></tt> or <tt class="docutils literal"><span class="pre">v1.0</span></tt> either or both
in your Python code and GitHub releases).</p>
<p>When this is done, if the latest GitHub version is not the same as the local
version, Alfred-Workflow will consider the remote version to be an update.
<strong>No further comparison of versions takes place</strong>.</p>
<p>Thus, calling <a class="reference internal" href="../api/workflow.html#workflow.workflow.Workflow" title="workflow.workflow.Workflow"><tt class="xref py py-class docutils literal"><span class="pre">Workflow</span></tt></a> with
<tt class="docutils literal"><span class="pre">update_settings={'version':</span> <span class="pre">'1.2',</span> <span class="pre">...}</span></tt> or
<tt class="docutils literal"><span class="pre">update_settings={'version':</span> <span class="pre">'v1.2',</span> <span class="pre">...}</span></tt> will be considered the same
version as the GitHub release tag <tt class="docutils literal"><span class="pre">v1.2</span></tt> or <tt class="docutils literal"><span class="pre">1.2</span></tt>.</p>
<div class="admonition danger">
<p class="first admonition-title">Danger</p>
<p class="last">If the local and GitHub version differ <em>in any other way</em> than starting
with <tt class="docutils literal"><span class="pre">v</span></tt>, the GitHub version will be considered an update.</p>
</div>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="icons.html" class="btn btn-neutral float-right" title="System icons"/>Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="background.html" class="btn btn-neutral" title="Background processes"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014, Dean Jackson.
    </p>
  </div>

  <a href="https://github.com/snide/sphinx_rtd_theme">Sphinx theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.9.6',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
  
<div class="github-fork-ribbon-wrapper right">
    <div class="github-fork-ribbon">
        <a href="https://github.com/deanishe/alfred-workflow">Fork me on GitHub</a>
    </div>
</div>
 


</body>
</html>